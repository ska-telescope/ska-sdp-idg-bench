

if(BUILD_CUDA)
file(GLOB  CUDA_SRC "./cuda*")
    foreach(testsourcefile ${CUDA_SRC})
    get_filename_component(testsourcefile ${testsourcefile} NAME)
    string(REPLACE ".cpp" "" testname ${testsourcefile})
    add_executable(${testname} ${testsourcefile})
    target_include_directories(${testname} PUBLIC ${CMAKE_SOURCE_DIR}/app)
    target_link_libraries(${testname} lib-cpu lib-cuda)
    target_compile_options(${testname} PRIVATE -DBUILD_CUDA)
    install(TARGETS ${testname} RUNTIME DESTINATION ${CMAKE_INSTALL_PREFIX}/bin)
  endforeach(testsourcefile ${CUDA_SRC})
endif()

if(BUILD_HIP)
file(GLOB  HIP_SRC "./hip*")
  foreach(testsourcefile ${HIP_SRC})
    get_filename_component(testsourcefile ${testsourcefile} NAME)
    string(REPLACE ".cpp" "" testname ${testsourcefile})
    add_executable(${testname} ${testsourcefile})
    target_include_directories(${testname} PUBLIC ${CMAKE_SOURCE_DIR}/app)
    target_link_libraries(${testname} lib-cpu lib-hip)
    install(TARGETS ${testname} RUNTIME DESTINATION ${CMAKE_INSTALL_PREFIX}/bin)
  endforeach(testsourcefile ${HIP_SRC})
endif()